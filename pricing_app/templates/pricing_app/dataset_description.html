{% extends "base.html" %}
{% block content %}
<div class="dataset-container">
    <h1 class="dataset-title">Dataset Overview</h1>

    <div class="dataset-grid">
        <!-- Category-wise sales -->
        <div class="dataset-card">
            <h3 class="dataset-card-title">Category-wise Sales</h3>
            <canvas id="categoryChart" class="dataset-chart"></canvas>
        </div>

        <!-- Sales Over Time -->
        <div class="dataset-card">
            <h3 class="dataset-card-title">Sales Over Time (by Category)</h3>
            <canvas id="salesChart" class="dataset-chart"></canvas>
        </div>
    </div>

    <div class="dataset-grid">
        <!-- Units Sold vs Price Difference -->
        <div class="dataset-card">
            <h3 class="dataset-card-title">Units Sold vs Price Difference</h3>
            <canvas id="priceDiffChart" class="dataset-chart"></canvas>
        </div>

        <!-- Units Sold vs Discount % -->
        <div class="dataset-card">
            <h3 class="dataset-card-title">Units Sold vs Discount %</h3>
            <canvas id="discountChart" class="dataset-chart"></canvas>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Category Pie
    new Chart(document.getElementById('categoryChart'), {
        type: 'pie',
        data: {
            labels: {{ category_labels_json|safe }},
            datasets: [{
                data: {{ category_values_json|safe }},
                backgroundColor: ["#6366f1","#10b981","#f59e0b","#ef4444"]
            }]
        },
        options: { responsive:true, maintainAspectRatio:false }
    });

    // Sales over time
    new Chart(document.getElementById('salesChart'), {
        type: 'line',
        data: { labels: {{ sales_labels_json|safe }}, datasets: {{ sales_datasets_json|safe }} },
        options: { responsive:true, maintainAspectRatio:false }
    });

    // Units Sold vs Price Difference
    const priceDiff = {{ price_diff_data_json|safe }};
    new Chart(document.getElementById('priceDiffChart'), {
        type: 'line',
        data: { labels: priceDiff.labels, datasets:[{ label:"Avg Units Sold", data: priceDiff.values, borderColor:"#3b82f6" }] },
        options:{ responsive:true, maintainAspectRatio:false }
    });

    // Units Sold vs Discount %
    const discountData = {{ discount_data_json|safe }};
    new Chart(document.getElementById('discountChart'), {
        type: 'line',
        data: { labels: discountData.labels, datasets:[{ label:"Avg Units Sold", data: discountData.values, borderColor:"#8b5cf6" }] },
        options:{ responsive:true, maintainAspectRatio:false }
    });
});
</script>
{% endblock %}
